<html ng-app="myApp">
<head>

    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="//use.fontawesome.com/3d61d6959e.js"></script>

    <link rel="stylesheet" href="//www.scriptr.io/lib/UIComponents/build/ide/css//components.min.css">
    
    <script src="//maps.google.com/maps/api/js?key=AIzaSyBcPYghFh_BXz4dDz-TXTHbU2iV3Wbf57I&libraries=drawing,visualization"></script>
    <script src="//www.scriptr.io/lib/UIComponents/build/ide/js/template_resources.min.js"></script>
    
</head> 
  
<script>

(function() {  
   $.urlParam = function(name){
	     var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
	     if (results==null){
	         return null;
	     }else{
	         return results[1] || 0;
	     }
	}

	$.getUrlVars = function() {
		var vars = [], hash;
		var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
		for(var i = 0; i < hashes.length; i++)
		{
			hash = hashes[i].split('=');
			vars.push(hash[0]);
			vars[hash[0]] = hash[1];
		}
		return vars;
	}
	  

      
    var underscore = angular.module('underscore', []);
		underscore.factory('_', ['$window', function($window) {		
  		return $window._; // assumes underscore has already been loaded on the page		
	}]);
    

    var wssConfig = ["wsClientProvider",function (wsClientProvider) {
   	 	wsClientProvider.setBaseUrl("wss://" + window.location.host + "/");   	 
        wsClientProvider.setToken($.urlParam("auth_token"));
        wsClientProvider.setPublishChannel("requestChannel");
        wsClientProvider.setSubscribeChannel("responseChannel");
    }];

    var httpsConfig = ["httpClientProvider",function (httpClientProvider) {
   	  httpClientProvider.setBaseUrl("https://" + window.location.host);
      httpClientProvider.setToken($.urlParam("auth_token"));
    }]

     var myApp= angular.module("myApp", ["underscore" , "WsClient", "HttpClient", "Chart", 'gridster', 'ui.bootstrap', 'ngRoute', 'Gauge', 'Speedometer', 'Odometer', 'Message', 'Map', 'Grid', 'toggle-switch', 'Slider', 'Button', 'IFrame', 'Accelerometer'])
     
     angular.module('myApp').run(cachedTemplates);  
      
     angular.module('myApp').config(wssConfig);
     angular.module('myApp').config(httpsConfig);
     
     myApp.config(function($interpolateProvider, $locationProvider) {
        $interpolateProvider.startSymbol('{[{');
        $interpolateProvider.endSymbol('}]}');
        $locationProvider.html5Mode({
          enabled: true,
          requireBase: false
        });
     });
  
  
     myApp.controller('RootCtrl', function($scope, $interpolate, $location) {
       var vm = this;
       vm.gridsterOptions = {
          pushing: false,
          
          minRows: 1, // the minimum height of the grid, in rows
          maxRows: 100,
          columns: 5, // the width of the grid, in columns
          colWidth: 'auto', // can be an integer or 'auto'.  'auto' uses the pixel width of the element divided by 'columns'
          rowHeight: 'match', // can be an integer or 'match'.  Match uses the colWidth, giving you square widgets.
          margins: [10, 10], // the pixel distance between each widget
          defaultSizeX: 2, // the default width of a gridster item, if not specifed
          defaultSizeY: 1, // the default height of a gridster item, if not specified
          mobileBreakPoint: 1024, // if the screen is not wider that this, remove the grid layout and stack the items
          minColumns: 1,
          resizable: {
            enabled: false
          },
          draggable: {
             enabled: false
          }
       };
       
        vm.init = function() {
        }
                vm.barFormatData1 = function(data){
                  return data;
                }
                vm.areaFormatData2 = function(data){
                  return data;
                }
                vm.lineFormatData3 = function(data){
                  return data;
                }
                vm.speedometerFormatData4 = function(data){
                  return data;
                }
                vm.speedometerFormatData5 = function(data){
                  return data;
                }
                vm.odometerFormatData6 = function(data){
                  return data;
                }
                vm.mapFormatData7 = function(data){
                  return data;
                }
                vm.accelerometerFormatData8 = function(data){
                  return data;
                }
     });
        	
})();
  
</script>

    <body>
      <div ng-controller="RootCtrl as vm" ng-init="vm.init();"> 
		<div gridster="vm.gridsterOptions">
          <ul>
                <li class="myItem" gridster-item='{sizeX: 2, sizeY: 2, col: 0 , row: 0 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Bar Chart" class="box-label">Bar Chart</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-chart
										type='bar'
										boxLabel='Bar Chart'
										stacked='true'
										xkey='y'
										ykeys='["a", "b"]'
										labels='["Serie A", "Serie B"]'
										colors='["#7ed38c","#dd7ca7"]'
										transport='wss'
										msg-tag='chart'
										data='[{"y":"2006","a":88,"b":20},{"y":"2007","a":30,"b":34},{"y":"2008","a":90,"b":42},{"y":"2009","a":89,"b":59},{"y":"2010","a":43,"b":61},{"y":"2011","a":85,"b":69},{"y":"2012","a":29,"b":65}]'
										grid-text-family='Source Sans Pro'
                                  		on-format-data='vm.barFormatData1'
                           ></scriptr-chart> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 2, sizeY: 2, col: 2 , row: 0 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Area Chart" class="box-label">Area Chart</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-chart
										type='area'
										boxLabel='Area Chart'
										xkey='y'
										ykeys='["a", "b"]'
										labels='["Serie A", "Serie B"]'
										colors='["#CC5464","#38B9D6"]'
										transport='wss'
										msg-tag='chart'
										grid-text-family='Source Sans Pro'
										data='[{"y":2000,"a":64,"b":82},{"y":2003,"a":53,"b":48},{"y":2004,"a":81,"b":58},{"y":2005,"a":68,"b":72},{"y":2008,"a":52,"b":60},{"y":20011,"a":55,"b":30},{"y":2013,"a":79,"b":40}]'
                                  		on-format-data='vm.areaFormatData2'
                           ></scriptr-chart> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 2, sizeY: 2, col: 0 , row: 2 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Line Chart" class="box-label">Line Chart</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-chart
										type='line'
										boxLabel='Line Chart'
										xkey='y'
										ykeys='["a", "b"]'
										labels='["Serie A", "Serie B"]'
										colors='["#FCC717","#38B9D6"]'
										transport='wss'
										msg-tag='chart'
										data='[{"y": 2006, "a": 2, "b": 3 }, { "y": 2007, "a": 82, "b": 68 }, { "y": 2009, "a": 70, "b": 99 }, { "y":2010, "a": 30, "b": 64 }, { "y": 2011, "a": 72, "b":100 }, { "y": 2012, "a": 81, "b": 81 }, { "y": 2013,"a": 52, "b": 39 } ]'
										grid-text-family='Source Sans Pro'
                                  		on-format-data='vm.lineFormatData3'
                           ></scriptr-chart> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 1, sizeY: 1, col: 4 , row: 0 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Speedometer" class="box-label">Speedometer</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-speedometer
										transport='wss'
										boxLabel='Speedometer'
										data='45'
										msg-tag='speedometer'
                                  		on-format-data='vm.speedometerFormatData4'
                           ></scriptr-speedometer> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 1, sizeY: 1, col: 4 , row: 1 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Speedometer" class="box-label">Speedometer</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-speedometer
										transport='wss'
										boxLabel='Speedometer'
										data='45'
										msg-tag='speedometer'
                                  		on-format-data='vm.speedometerFormatData5'
                           ></scriptr-speedometer> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 2, sizeY: 1, col: 2 , row: 2 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Odometer" class="box-label">Odometer</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-odometer
										transport='wss'
										boxLabel='Odometer'
										msg-tag='odometer'
										data='28022017'
										animation='count'
										duration='1000'
										size='2'
                                  		on-format-data='vm.odometerFormatData6'
                           ></scriptr-odometer> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 2, sizeY: 2, col: 2 , row: 3 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="Map" class="box-label">Map</div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-map
										transport='wss'
										boxLabel='Map'
										clustered-view='true'
										cluster-zoom='8'
										heatmap='true'
										bounce='true'
										resize='false'
										data='{ "253812" : { "550153" : [ { "lat" : {"value": "40.84969"}, "long" :{"value": "-73.94168"}, "bounce": {"value" : "true"}, "speed" : { "value" : "8", "description" :"Maximum Speed Recorded (since the previous reading)" }, "fuel" : {"value" : "30", "description" : "Percentage of Fuel Remaining" },"fuelRate" : { "value" : "1.3", "description" : "Rate of FuelConsumption" }, "rpm" : { "value" : "2818", "description" : "EngineSpeed" }, "coolantTemperature" : { "value" : "91", "description" :"Engine Temperature" }, "voltage" : { "value" : "13.99", "description" :"Battery Voltage" }, "status" : { "value" : "RUNNING" }, "address" : {},"mileage" : { "value" : "55101" }, "make" : { "value" : "Toyota" },"model" : { "value" : "Tacoma" }, "snr" : { "value" : "11","description" : "Signal to Noise Ratio" }, "rssi" : { "value" : "61","description" : "Received Signal Strength Indicator" } }, { "lat" :{"value": "40.84919"}, "long" : {"value": "-73.93897000000001"}, "speed": { "value" : "5", "description" : "Maximum Speed Recorded (since theprevious reading)" }, "fuel" : { "value" : "57", "description" :"Percentage of Fuel Remaining" }, "fuelRate" : { "value" : "1.4","description" : "Rate of Fuel Consumption" }, "rpm" : { "value" :"2838", "description" : "Engine Speed" }, "coolantTemperature" : {"value" : "94", "description" : "Engine Temperature" }, "voltage" : {"value" : "13.15", "description" : "Battery Voltage" }, "status" : {"value" : "RUNNING" }, "address" : {}, "mileage" : { "value" : "55101"}, "make" : { "value" : "Toyota" }, "model" : { "value" : "Tacoma" },"snr" : { "value" : "9", "description" : "Signal to Noise Ratio" },"rssi" : { "value" : "48", "description" : "Received Signal StrengthIndicator" } }, { "lat" : {"value": "40.848600000000005"}, "long" :{"value": "-73.93648"}, "speed" : { "value" : "9", "description" :"Maximum Speed Recorded (since the previous reading)" }, "fuel" : {"value" : "76", "description" : "Percentage of Fuel Remaining" },"fuelRate" : { "value" : "1.2", "description" : "Rate of FuelConsumption" }, "rpm" : { "value" : "2465", "description" : "EngineSpeed" }, "coolantTemperature" : { "value" : "97", "description" :"Engine Temperature" }, "voltage" : { "value" : "13.39", "description" :"Battery Voltage" }, "status" : { "value" : "RUNNING" }, "address" : {},"mileage" : { "value" : "55101" }, "make" : { "value" : "Toyota" },"model" : { "value" : "Tacoma" }, "snr" : { "value" : "11","description" : "Signal to Noise Ratio" }, "rssi" : { "value" : "69","description" : "Received Signal Strength Indicator" } } ], "source" :"simulator", "order" : [ "550153" ] }, "253815" : { "550191" : [ { "lat": {"value": "40.80913"}, "long" : {"value": "-73.90327"}, "speed" : {"value" : "7", "description" : "Maximum Speed Recorded (since theprevious reading)" }, "fuel" : { "value" : "56", "description" :"Percentage of Fuel Remaining" }, "fuelRate" : { "value" : "1.2","description" : "Rate of Fuel Consumption" }, "rpm" : { "value" :"2123", "description" : "Engine Speed" }, "coolantTemperature" : {"value" : "100", "description" : "Engine Temperature" }, "voltage" : {"value" : "13.45", "description" : "Battery Voltage" }, "status" : {"value" : "RUNNING" }, "address" : {}, "mileage" : { "value" : "55043"}, "make" : { "value" : "Saab" }, "model" : { "value" : "9-3" }, "snr" :{ "value" : "13", "description" : "Signal to Noise Ratio" }, "rssi" : {"value" : "49", "description" : "Received Signal Strength Indicator" }}, { "lat" : {"value": "40.807500000000004"}, "long" : {"value":"-73.90557000000001"}, "speed" : { "value" : "6", "description" :"Maximum Speed Recorded (since the previous reading)" }, "fuel" : {"value" : "16", "description" : "Percentage of Fuel Remaining" },"fuelRate" : { "value" : "1.7", "description" : "Rate of FuelConsumption" }, "rpm" : { "value" : "1946", "description" : "EngineSpeed" }, "coolantTemperature" : { "value" : "95", "description" :"Engine Temperature" }, "voltage" : { "value" : "12.87", "description" :"Battery Voltage" }, "status" : { "value" : "RUNNING" }, "address" : {},"mileage" : { "value" : "55043" }, "make" : { "value" : "Saab" },"model" : { "value" : "9-3" }, "snr" : { "value" : "13", "description" :"Signal to Noise Ratio" }, "rssi" : { "value" : "59", "description" :"Received Signal Strength Indicator" } } ], "source" : "simulator","order" : [ "550191" ] } }'
										sources-info='{"simulator": {"label": "Carvoyant"}}'
										msg-tag='everyone-main-live'
                                  		on-format-data='vm.mapFormatData7'
                           ></scriptr-map> </div>
                        </div>
                    </div>
                </li>
                <li class="myItem" gridster-item='{sizeX: 2, sizeY: 2, col: 0 , row: 4 }'>
                    <div class="box">
                        <div class="box-content">
                          <div  style="height: 30px;" tooltip-placement="bottom" uib-tooltip="" class="box-label"></div>
                          <div  style="height: calc(100% - 30px)" > <scriptr-accelerometer
										transport='wss'
										msg-tag='accelerometer'
                                  		on-format-data='vm.accelerometerFormatData8'
                           ></scriptr-accelerometer> </div>
                        </div>
                    </div>
                </li>
          </ul>
        </div>
      </div>
  </body>  
</html>